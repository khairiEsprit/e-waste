<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>
<?import javafx.geometry.Insets?>
<?import javafx.scene.control.cell.PropertyValueFactory?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>

<?import java.net.URL?>
<AnchorPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.example.ewaste.controllers.HistoriquePoubelleController"
            prefHeight="600.0" prefWidth="800.0">

    <!-- Styles CSS -->
    <stylesheets>
        <URL value="@../style/style.css"/>
    </stylesheets>

    <VBox spacing="10" layoutX="50" layoutY="20">
        <!-- Titre -->
        <Label text="Gestion des Événements de Poubelle" style="-fx-font-size: 20px; -fx-font-weight: bold;"/>

        <!-- Champ pour l'ID de la poubelle -->
        <HBox spacing="10">
            <Label text="ID Poubelle:"/>
            <TextField fx:id="poubelleIdField" promptText="Entrez l'ID de la poubelle"/>
            <Button text="Historique" onAction="#handleAfficherHistorique"/>
        </HBox>

        <!-- Filtre par type d'événement -->
        <HBox spacing="10">
            <Label text="Filtrer par Type :"/>
            <ComboBox fx:id="typeFilterComboBox" promptText="Tous les types"/>
        </HBox>

        <!-- Champ pour la quantité de déchets -->
        <HBox spacing="10">
            <Label text="Quantité de Déchets (kg):"/>
            <TextField fx:id="quantiteDechetsField" promptText="Entrez la quantité de déchets"/>
        </HBox>

        <!-- Boutons pour les événements -->
        <HBox spacing="10">
            <Button text="Remplissage" onAction="#handleRemplissageEvent">
                <!--graphic>
                    <ImageView>
                        <Image url="@../assets/fill.png"/>
                    </ImageView>
                </graphic!-->
            </Button>
            <Button text="Vidage" onAction="#handleVidageEvent">
                <!--graphic>
                    <ImageView>
                        <Image url="@../assets/empty.png"/>
                    </ImageView>
                </graphic!-->
            </Button>
            <Button text="Panne" onAction="#handlePanneEvent">
                <!--graphic>
                    <ImageView>
                        <Image url="@../assets/error.png"/>
                    </ImageView>
                </graphic!-->
            </Button>
            <Button text="Réparation" onAction="#handleReparationEvent">
                <!--graphic>
                    <ImageView>
                        <Image url="@../assets/repair.png"/>
                    </ImageView>
                </graphic!-->
            </Button>
        </HBox>

        <!-- Bouton pour l'alerte de remplissage maximal -->
        <Button text="Alerte Remplissage Max" onAction="#handleAlerteRemplissageMax"/>

        <!-- TableView pour afficher l'historique -->
        <TableView fx:id="historiqueTable">
            <columns>
                <TableColumn fx:id="idColumn" text="ID"/>
                <TableColumn fx:id="idPoubelleColumn" text="ID Poubelle">
                    <!-- Ajouter le PropertyValueFactory directement dans le FXML -->
                    <cellValueFactory>
                        <PropertyValueFactory property="id_poubelle" />
                    </cellValueFactory>
                </TableColumn>

                <!--TableColumn fx:id="idPoubelleColumn" text="ID Poubelle"/-->
                <TableColumn fx:id="dateEvenementColumn" text="Date Événement"/>
                <TableColumn fx:id="typeEvenementColumn" text="Type"/>
                <TableColumn fx:id="descriptionColumn" text="Description"/>
                <TableColumn fx:id="quantiteDechetsColumn" text="Quantité (kg)"/>
            </columns>
        </TableView>

        <!-- Boutons pour exporter les données -->
        <HBox spacing="10">
            <Button text="Exporter en CSV" onAction="#handleExportCSV"/>
            <!--Button text="Exporter en PDF" onAction="#handleExportPDF"/-->
        </HBox>

        <!-- Label pour afficher le statut -->
        <Label fx:id="statusLabel" style="-fx-text-fill: green; -fx-font-weight: bold;"/>
    </VBox>

</AnchorPane>